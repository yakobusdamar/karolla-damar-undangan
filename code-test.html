<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Undangan Pernikahan</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,700;1,400&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css" rel="stylesheet" />

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f04299",
                        "background-light": "#f8f6f7",
                        "background-dark": "#221019",
                        "text-light": "#67595E",
                        "text-dark": "#E5E0E2",
                        "rose-gold-100": "#FBF1F3",
                        "rose-gold-200": "#F7E3E8",
                        "rose-gold-300": "#EBC2CD",
                        "rose-gold-text": "#67595E"
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans"],
                        "serif": ["Cormorant Garamond", "serif"],
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        .text-shadow {
            text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.5);
        }
        body {
            min-height: max(884px, 100dvh);
        }
        
        /* Custom Styles & Tailwind Configuration */
        :root {
            --rose-gold-text: #9B596F;
            --rose-gold-300: #EAD0D9;
            --bg-color: #F8F4F0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
        }

        .text-rose-gold-text { color: var(--rose-gold-text); }
        .bg-rose-gold-300 { background-color: var(--rose-gold-300); }
        .hover\:bg-rose-gold-300\/80:hover { background-color: rgba(234, 208, 217, 0.8); }

        /* Custom Font for Names */
        .font-serif-custom {
            font-family: 'Playfair Display', serif;
        }
    </style>
</head>

<body class="font-display bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark">
    <div class="flex flex-col">
        <div class="relative flex h-[90vh] min-h-[400px] w-full flex-col justify-between overflow-hidden pb-20 sm:pb-10">
            <div class="absolute inset-0 bg-center bg-no-repeat bg-cover"
                style='background-image: url("img_resource/hero4.jpg");'>
                <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
            </div>
            <div class="relative z-10 flex flex-col items-center justify-end flex-grow text-center text-white p-6">
                <p class="mb-2 text-lg text-shadow">Pernikahan</p>
                <h1 class="text-3xl font-bold leading-tight text-shadow mb-4 font-serif">Karolla &amp; Damar</h1>
                <p class="text-lg text-shadow">29 November 2025</p>
                <p class="text-lg text-shadow">Kepada Yth. <span id="invitee"></span></p>
                <!-- add small "mohon maaf atas penulisan nama" -->
                <p class="mt-4 italic text-shadow" style="font-size: 8pt;">"Mohon maaf apabila ada kesalahan penulisan gelar / nama"</p>
            </div>
            <div class="relative z-10 p-6 pb-3">
                <button id="openInvitation"
                    class="w-full flex items-center justify-center gap-2 rounded-lg h-12 px-6 bg-primary text-white text-base font-bold shadow-lg transform hover:scale-105 transition-transform">
                    <span class="material-symbols-outlined">
                        mail
                    </span>
                    <span class="truncate">Buka Undangan</span>
                </button>
            </div>
        </div>
        <div class="py-16 px-6 text-center">
            <p class="font-serif italic text-2xl mb-4 leading-relaxed text-text-light dark:text-text-dark">
                “Demikianlah mereka bukan lagi dua, melainkan satu. Karena itu, apa yang telah dipersatukan Allah, tidak
                boleh diceraikan manusia.”
            </p>
            <p class="font-serif text-lg text-text-light/80 dark:text-text-dark/80">Matius 19:6</p>
        </div>
        <div class="px-6 py-10 bg-white/50 dark:bg-black/10">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold font-serif text-gray-800 dark:text-gray-200 mb-2">Mempelai</h2>
                <p class="text-base text-text-light dark:text-text-dark">Pasangan berbahagia</p>
            </div>
            <div class="flex flex-col gap-10">
                <div class="flex flex-col items-center text-center">
                    <img alt="Mempelai Pria"
                        class="w-40 h-40 rounded-full object-cover mb-4 border-4 border-primary/50 shadow-lg"
                        src="img_resource/damar.jpg" />
                    <h3 class="text-2xl font-bold font-serif text-gray-800 dark:text-gray-200">Yakobus Damar Pradiptojati</h3>
                    <p class="text-sm text-text-light dark:text-text-dark mb-2">Putra ke-1 dari<br>Bapak Titus Budi Setyoko &amp; Ibu Maria Sihmurni Sayekti</p>
                </div>
                <div class="flex flex-col items-center text-center">
                    <img alt="Mempelai Wanita"
                        class="w-40 h-40 rounded-full object-cover mb-4 border-4 border-primary/50 shadow-lg"
                        src="img_resource/olla.jpg" />
                    <h3 class="text-2xl font-bold font-serif text-gray-800 dark:text-gray-200">Karolla Leonarda Maria Mursita Putri</h3>
                    <p class="text-sm text-text-light dark:text-text-dark mb-2">Putri ke-3 dari<br>Bapak Ignatius Mursito &amp; Ibu Laurentia Hertatik</p>
                </div>
            </div>
        </div>
        <div class="py-16 px-6 text-center bg-background-light dark:bg-background-dark">
            <h2 class="text-4xl font-bold font-serif text-gray-800 dark:text-gray-200 mb-6">Sakramen Perkawinan</h2>
            <div class="space-y-4 text-lg">
                <div class="flex items-center justify-center gap-3">
                    <span class="material-symbols-outlined text-primary text-2xl">calendar_month</span>
                    <p>Sabtu, 29 November 2025</p>
                </div>
                <div class="flex items-center justify-center gap-3">
                    <span class="material-symbols-outlined text-primary text-2xl">schedule</span>
                    <p>09:00 WIB</p>
                </div>
                <div class="flex items-center justify-center gap-3">
                    <span class="material-symbols-outlined text-primary text-2xl">location_on</span>
                    <p>Gereja Katedral Semarang</p>
                </div>
            </div>
            <div class="mt-8 flex flex-col gap-4 max-w-xs mx-auto">
                <a
                    href="https://maps.app.goo.gl/VmYHKbsvAX2Su4Z8A" target="_blank"
                    class="w-full flex items-center justify-center gap-2 rounded-lg h-12 px-6 bg-primary text-white text-base font-bold shadow-lg transform hover:scale-105 transition-transform">
                    <span class="material-symbols-outlined">map</span>
                    <span>Buka Peta</span>
                </a>
                <a
                    href="https://www.youtube.com/@myweddinglivestreaming8651" target="_blank"
                    class="w-full flex items-center justify-center gap-2 rounded-lg h-12 px-6 bg-gray-600 text-white text-base font-bold shadow-lg transform hover:scale-105 transition-transform">
                    <span class="material-symbols-outlined">live_tv</span>
                    <span>Tonton Langsung</span>
                </a>
            </div>
        </div>
        <div class="px-6 py-10 bg-white/50 dark:bg-black/10 text-center">
            <h2 class="text-3xl font-bold font-serif text-gray-800 dark:text-gray-200 mb-4">Simpan Tanggal</h2>
            <div class="flex justify-center gap-4 text-gray-800 dark:text-gray-200">
                <div class="flex flex-col items-center">
                    <span class="text-4xl font-bold">123</span>
                    <span class="text-sm">Hari</span>
                </div>
                <div class="flex flex-col items-center">
                    <span class="text-4xl font-bold">09</span>
                    <span class="text-sm">Jam</span>
                </div>
                <div class="flex flex-col items-center">
                    <span class="text-4xl font-bold">45</span>
                    <span class="text-sm">Menit</span>
                </div>
                <div class="flex flex-col items-center">
                    <span class="text-4xl font-bold">30</span>
                    <span class="text-sm">Detik</span>
                </div>
            </div>
        </div>
        <div class="px-6 py-16 bg-rose-gold-100 text-rose-gold-text">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold font-serif text-rose-gold-text mb-2">RSVP</h2>
                <p class="text-base text-rose-gold-text/80">Mohon konfirmasi kehadiran Anda</p>
            </div>
            <form class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-rose-gold-text mb-1" for="name">Nama</label>
                    <input
                        class="w-full rounded-lg border-rose-gold-300 bg-white focus:ring-rose-gold-300 focus:border-rose-gold-300 text-rose-gold-text"
                        id="name" name="name" placeholder="Nama Anda" type="text" />
                </div>
                <div>
                    <label class="block text-sm font-medium text-rose-gold-text mb-1" for="attendance">Kehadiran</label>
                    <select
                        class="w-full rounded-lg border-rose-gold-300 bg-white focus:ring-rose-gold-300 focus:border-rose-gold-300 text-rose-gold-text"
                        id="attendance" name="attendance">
                        <option>Hadir</option>
                        <option>Tidak Hadir</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-rose-gold-text mb-1" for="attendees">Jumlah
                        Tamu</label>
                    <select
                        class="w-full rounded-lg border-rose-gold-300 bg-white focus:ring-rose-gold-300 focus:border-rose-gold-300 text-rose-gold-text"
                        id="attendees" name="attendees">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <button
                    id="submitRsvp"
                    class="w-full flex items-center justify-center gap-2 rounded-lg h-12 px-6 bg-rose-gold-300 text-rose-gold-text text-base font-bold shadow-lg transform hover:scale-105 transition-transform"
                    type="submit">
                    Kirim RSVP
                </button>
            </form>
            <div class="mt-12">
                <h3 class="text-2xl font-serif text-rose-gold-text mb-6 text-center">Ucapan &amp; Doa</h3>
                <form class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-rose-gold-text mb-1 sr-only"
                            for="wishes">Nama</label>
                        <textarea
                            class="w-full rounded-lg border-rose-gold-300 bg-white focus:ring-rose-gold-300 focus:border-rose-gold-300 text-rose-gold-text"
                            id="nama_wishes" name="nama_wishes"
                            placeholder="Masukkan nama Anda" rows="4"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-rose-gold-text mb-1 sr-only"
                            for="wishes">Pesan</label>
                        <textarea
                            class="w-full rounded-lg border-rose-gold-300 bg-white focus:ring-rose-gold-300 focus:border-rose-gold-300 text-rose-gold-text"
                            id="wishes" name="wishes"
                            placeholder="Kirim ucapan &amp; doa terbaik Anda untuk kedua mempelai" rows="4"></textarea>
                    </div>
                    <button
                        class="w-full flex items-center justify-center gap-2 rounded-lg h-12 px-6 bg-rose-gold-300 text-rose-gold-text text-base font-bold shadow-lg transform hover:scale-105 transition-transform"
                        type="submit">
                        Kirim
                    </button>
                </form>
                <div class="space-y-4 max-h-60 overflow-y-auto pr-2 mt-8">
                </div>
            </div>
        </div>
        <div class="px-6 py-16 bg-rose-gold-200">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold font-serif text-rose-gold-text mb-2">Galeri</h2>
                <p class="text-base text-rose-gold-text/80">Momen berharga kami</p>
            </div>
            <div class="grid grid-cols-2 gap-2">
                <a href="img_resource/gallery1.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery1.jpg" />
                </a>
                <a href="img_resource/gallery2.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery2.jpg" />
                </a>
                <a href="img_resource/gallery3.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery3.jpg" />
                </a>
                <a href="img_resource/gallery4.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery4.jpg" />
                </a>
                <a href="img_resource/gallery5.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery5.jpg" />
                </a>
                <a href="img_resource/gallery6.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery6.jpg" />
                </a>
                <a href="img_resource/gallery7.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery7.jpg" />
                </a>
                <a href="img_resource/gallery8.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery8.jpg" />
                </a>
                <a href="img_resource/gallery9.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery9.jpg" />
                </a>
                <a href="img_resource/gallery10.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery10.jpg" />
                </a>
                <a href="img_resource/gallery11.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery11.jpg" />
                </a>
                <a href="img_resource/gallery12.jpg"
                    data-lightbox="mygallery" data-title="Sesi Prewedding Karolla & Damar">
                    <img alt="Gallery image" class="w-full h-auto object-cover rounded-lg aspect-square"
                        src="img_resource/gallery12.jpg" />
                </a>
            </div>
        </div>
        <div class="px-6 py-16 bg-rose-gold-100 text-rose-gold-text">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold font-serif text-rose-gold-text mb-2">Hadiah Pernikahan</h2>
                <p class="text-base text-rose-gold-text/80">Kehadiran Anda adalah hadiah terbesar, namun jika Anda ingin
                    memberikan hadiah, kami akan berterima kasih atas kontribusi untuk masa depan kami bersama.</p>
            </div>
            <div class="space-y-6 w-full">
                <!-- Kartu Rekening 1 -->
                <div class="p-6 bg-white/70 shadow-lg rounded-xl text-center backdrop-blur-sm border border-white">
                    <p class="font-serif-custom text-lg text-rose-gold-text">Karolla Leonarda Maria Mursita Putri</p>
                    <!-- ID untuk menampilkan nomor rekening, dan data-account untuk nomor rekening bersih yang akan disalin -->
                    <p id="accDisplay1" class="text-sm font-bold text-rose-gold-text my-2 select-all">429-104-4101</p>
                    <p class="text-sm text-rose-gold-text/80">Bank BCA</p>
                    <button data-account="4291044101" onclick="copyAccount(this)"
                        class="mt-4 px-6 py-2 text-sm font-bold text-white bg-rose-gold-text rounded-full shadow-md hover:bg-rose-gold-text/90 transition transform hover:scale-[1.02] active:scale-[0.98]">
                        Salin Rekening
                    </button>
                </div>

                <!-- Kartu Rekening 2 -->
                <div class="p-6 bg-white/70 shadow-lg rounded-xl text-center backdrop-blur-sm border border-white">
                    <p class="font-serif-custom text-lg text-rose-gold-text">Damar Pradiptojati</p>
                    <!-- ID untuk menampilkan nomor rekening, dan data-account untuk nomor rekening bersih yang akan disalin -->
                    <p id="accDisplay2" class="text-2sm font-bold text-rose-gold-text my-2 select-all">141-001-9734-987</p>
                    <p class="text-sm text-rose-gold-text/80">Bank Mandiri</p>
                    <button data-account="1410019734987" onclick="copyAccount(this)"
                        class="mt-4 px-6 py-2 text-sm font-bold text-white bg-rose-gold-text rounded-full shadow-md hover:bg-rose-gold-text/90 transition transform hover:scale-[1.02] active:scale-[0.98]">
                        Salin Rekening
                    </button>
                </div>
                <!-- Toast Notification Element -->
                <div id="toastNotification"
                    class="fixed bottom-5 left-1/2 -translate-x-1/2 opacity-0 transition-opacity duration-300 ease-out p-3 rounded-xl shadow-2xl bg-gray-800 text-white text-sm font-semibold max-w-xs z-50 pointer-events-none">
                    <!-- Pesan Toast akan dimasukkan di sini oleh JavaScript -->
                </div>
            </div>
        </div>
        <div class="py-16 px-6 text-center bg-background-light dark:bg-background-dark">
            <p class="font-serif text-lg leading-relaxed text-text-light dark:text-text-dark">
                Merupakan suatu kehormatan dan kebahagiaan bagi kami, apabila Bapak/Ibu/Saudara/i berkenan hadir dan
                memberikan doa restu.
            </p>
            <p class="font-serif text-lg leading-relaxed text-text-light dark:text-text-dark mt-4">
                Atas kehadiran dan doa restunya, kami mengucapkan terima kasih.
            </p>
            <p class="font-serif text-xl font-bold text-text-light dark:text-text-dark mt-8">
                Kami yang berbahagia,
            </p>
            <p class="font-serif text-2xl font-bold text-primary mt-2">
                Karolla &amp; Damar
            </p>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/js/lightbox.min.js"></script>
    <script>
        // Get invitee name from URL parameter
        const inviteeParam = new URLSearchParams(window.location.search).get('to');
        if (inviteeParam) {
            document.getElementById('invitee').textContent = decodeURIComponent(inviteeParam.replace(/\+/g, ' '));
        } else {
            document.getElementById('invitee').textContent = 'Bapak/Ibu/Saudara/i';
        }
        // Lock the page initially
        window.scrollTo(0, 0);
        document.body.style.overflow = 'hidden';
        document.body.style.height = '100vh';

        // Add click handler to unlock and scroll
        document.getElementById('openInvitation').addEventListener('click', function () {
            // Unlock the page
            document.body.style.overflow = '';
            document.body.style.height = '';

            // Smooth scroll to the next section
            const heroSection = document.querySelector('.flex.flex-col > div:first-child');
            const nextSection = heroSection.nextElementSibling;

            if (nextSection) {
                nextSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });

        // Set the wedding date - November 29, 2025 at 09:00 WIB
        const weddingDate = new Date('2025-11-29T09:00:00+07:00').getTime();

        function updateCountdown() {
            const now = new Date().getTime();
            const distance = weddingDate - now;

            // Calculate time units
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Get all countdown elements
            const countdownElements = document.querySelectorAll('.flex.justify-center.gap-4 .text-4xl');

            if (countdownElements.length >= 4) {
                // Update the HTML
                countdownElements[0].textContent = days >= 0 ? days : 0;
                countdownElements[1].textContent = hours >= 0 ? hours : 0;
                countdownElements[2].textContent = minutes >= 0 ? minutes : 0;
                countdownElements[3].textContent = seconds >= 0 ? seconds : 0;
            }
        }

        // Update countdown immediately and then every second
        updateCountdown();
        setInterval(updateCountdown, 1000);

        function showToast(message) {
            const toast = document.getElementById('toastNotification');

            // 1. Masukkan pesan
            toast.textContent = message;

            // 2. Tampilkan toast (ubah opacity dari 0 ke 1)
            // Hapus kelas opacity-0 dan tambahkan kelas opacity-100
            toast.classList.remove('opacity-0');
            toast.classList.add('opacity-100');

            // 3. Atur waktu tunggu (hilangkan setelah 3 detik)
            setTimeout(() => {
                // Sembunyikan toast (ubah opacity dari 1 ke 0)
                toast.classList.remove('opacity-100');
                toast.classList.add('opacity-0');
            }, 3000); // 3000 milidetik = 3 detik
        }

        /**
         * Fungsi untuk menyalin nomor rekening ke clipboard.
         * @param {HTMLButtonElement} buttonElement - Elemen tombol yang diklik.
         */
        function copyAccount(buttonElement) {
            // Ambil nomor rekening yang 'bersih' (tanpa hyphen/strip) dari atribut data-account
            const accountNumber = buttonElement.getAttribute('data-account');

            // Coba gunakan navigator.clipboard.writeText (metode modern)
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(accountNumber)
                    .then(() => {
                        showToast(`Nomor ${accountNumber} berhasil disalin!`);
                    })
                    .catch(err => {
                        console.error('Gagal menyalin menggunakan API modern:', err);
                        // Fallback ke metode lama jika gagal
                        fallbackCopy(accountNumber);
                    });
            } else {
                // Fallback ke metode lama (document.execCommand)
                fallbackCopy(accountNumber);
            }
        }

        /**
         * Metode salin lama menggunakan elemen input sementara (Fallback)
         * @param {string} text - Teks yang akan disalin.
         */
        function fallbackCopy(text) {
            const tempInput = document.createElement('input');
            tempInput.value = text;

            // Menjadikan input tidak terlihat
            tempInput.style.position = 'absolute';
            tempInput.style.left = '-9999px';

            document.body.appendChild(tempInput);
            tempInput.select();
            tempInput.setSelectionRange(0, 99999); // Untuk perangkat mobile

            try {
                // Jalankan perintah salin
                document.execCommand('copy');
                showToast(`Nomor ${text} berhasil disalin (Fallback)!`);
            } catch (err) {
                console.error('Gagal menyalin menggunakan fallback:', err);
                showToast('Gagal menyalin. Silakan salin manual.');
            } finally {
                // Hapus elemen input sementara
                document.body.removeChild(tempInput);
            }
        }

        $('#submitRsvp').on('click', function (e) {
            e.preventDefault();
            var name = $('#name').val();
            var attendance = $('#attendance').val();
            var attendees = $('#attendees').val();
            if (!name) {
                showToast('Mohon isi nama Anda.');
                return;
            }
            if (attendance === 'Hadir' && (!attendees || attendees === '0')) {
                showToast('Mohon pilih jumlah tamu.');
                return;
            }
            if (attendance === 'Tidak Hadir') {
                attendees = '0';
            }
            // Format pesan untuk WhatsApp
            var message = "";
            if (attendance === 'Hadir') {
                message = `Halo Karolla & Damar, saya *${name}*.\nSaya akan *${attendance}* pada pernikahan kalian.\nJumlah tamu: *${attendees}* orang.\nTerima kasih!`;
            } else {
                message = `Halo Karolla & Damar, saya *${name}*.\nSaya mohon maaf karena *${attendance}* pada pernikahan kalian.\nTerima kasih!`;
            }   
            var encodedMessage = encodeURIComponent(message);
            var whatsappUrl = `https://wa.me/6281392263880?text=${encodedMessage}`; // Ganti dengan nomor WhatsApp penerima yang benar
            window.open(whatsappUrl, '_blank');
        });
    </script>
    <script>
        // API endpoints
        const API_BASE_URL = 'https://n8n-h0dsuwveifgm.rendang.sumopod.my.id/webhook';
        const SUBMIT_WISH_URL = `${API_BASE_URL}/set-wish`;
        const GET_WISHES_URL = `${API_BASE_URL}/get-wish`;
        
        /**
         * Submit a new wish/greeting
         * @param {string} nama - Name of the person sending the wish
         * @param {string} ucapan - The wish/greeting message
         * @returns {Promise<Object>} Response from the API
         */
        async function submitWish(nama, ucapan) {
            try {
                const response = await fetch(SUBMIT_WISH_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        nama: nama,
                        ucapan: ucapan
                    })
                });
        
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
        
                const data = await response.json();
                return {
                    success: true,
                    data: data
                };
            } catch (error) {
                console.error('Error submitting wish:', error);
                return {
                    success: false,
                    error: error.message
                };
            }
        }
        
        /**
         * Get all wishes/greetings
         * @returns {Promise<Array>} Array of wishes
         */
        async function getWishes() {
            try {
                const response = await fetch(GET_WISHES_URL, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
        
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
        
                const data = await response.json();
                return {
                    success: true,
                    data: data
                };
            } catch (error) {
                console.error('Error fetching wishes:', error);
                return {
                    success: false,
                    error: error.message,
                    data: []
                };
            }
        }
        
        /**
         * Format date from API response
         * @param {string} dateString - ISO date string
         * @returns {string} Formatted date string
         */
        function formatDate(dateString) {
            const date = new Date(dateString);
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            return date.toLocaleDateString('id-ID', options);
        }
        
        // Example usage with the form
        document.addEventListener('DOMContentLoaded', async function() {
            const form = document.querySelector('form');
            const wishesContainer = document.querySelector('.space-y-4.max-h-60');
            const nama_wishesTextarea = document.getElementById('nama_wishes');
            const wishesTextarea = document.getElementById('wishes');
            
            // Load wishes on page load
            await loadWishes();
            
            // Handle form submission
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const nama = nama_wishesTextarea.value.trim();
                if (!nama) return;
                
                const ucapan = wishesTextarea.value.trim();
                if (!ucapan) {
                    alert('Mohon tulis ucapan Anda terlebih dahulu');
                    return;
                }
                
                // Submit the wish
                const result = await submitWish(nama, ucapan);
                
                if (result.success) {
                    alert('Ucapan berhasil dikirim!');
                    wishesTextarea.value = '';
                    // Reload wishes
                    await loadWishes();
                } else {
                    alert('Gagal mengirim ucapan. Silakan coba lagi.');
                }
            });
            
            // Function to load and display wishes
            async function loadWishes() {
                const result = await getWishes();
                
                if (result.success && result.data.length > 0) {
                    // Sort by row_number descending (newest first)
                    const sortedWishes = result.data.sort((a, b) => b.row_number - a.row_number);
                    
                    wishesContainer.innerHTML = sortedWishes.map(wish => `
                        <div class="p-4 bg-white/50 rounded-lg">
                            <p class="font-bold text-rose-gold-text">${escapeHtml(wish.nama)}</p>
                            <p class="text-sm text-rose-gold-text/80">${escapeHtml(wish.ucapan)}</p>
                            ${wish.tanggal ? `<p class="text-xs text-rose-gold-text/60 mt-1">${formatDate(wish.tanggal)}</p>` : ''}
                        </div>
                    `).join('');
                }
            }
            
            // Helper function to escape HTML
            function escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        });
        
        // Export functions for use in modules
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = { submitWish, getWishes, formatDate };
        }
    </script>
</body>

</html>
